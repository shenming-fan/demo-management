<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.admin.modules.tool.mapper.GenTableMapper">

    <!-- 查询数据库中尚未导入的表 -->
    <select id="selectDbTableList" resultType="java.util.LinkedHashMap">
        SELECT
            table_name AS tableName,
            table_comment AS tableComment,
            create_time AS createTime
        FROM information_schema.tables
        WHERE table_schema = (SELECT DATABASE())
          AND table_name NOT LIKE 'gen_%'
          AND table_name NOT IN (SELECT table_name FROM gen_table)
        <if test="tableName != null and tableName != ''">
            AND table_name LIKE CONCAT('%', #{tableName}, '%')
        </if>
        ORDER BY create_time DESC
    </select>

    <!-- 查询指定表的列信息 -->
    <select id="selectDbColumnList" resultType="java.util.LinkedHashMap">
        SELECT
            column_name AS columnName,
            column_comment AS columnComment,
            column_type AS columnType,
            column_key AS columnKey,
            is_nullable AS isNullable,
            ordinal_position AS sort,
            extra
        FROM information_schema.columns
        WHERE table_schema = (SELECT DATABASE())
          AND table_name = #{tableName}
        ORDER BY ordinal_position
    </select>

</mapper>
